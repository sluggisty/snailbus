# Snailbus Environment Configuration
# Copy this file to .env and adjust values for your environment

# =============================================================================
# REQUIRED CONFIGURATION
# =============================================================================

# PostgreSQL database connection URL
# Required: Yes
# Default: postgres://snail:snail_secret@localhost:5432/snailbus?sslmode=disable
# Format: postgres://username:password@host:port/database?sslmode=disable
DATABASE_URL=postgres://snail:snail_secret@localhost:5432/snailbus?sslmode=disable

# =============================================================================
# SERVER CONFIGURATION
# =============================================================================

# Main API server port
# Required: No
# Default: 8080
# Valid range: 1-65535
PORT=8080

# Prometheus metrics server port
# Required: No
# Default: 9090
# Valid range: 1-65535
METRICS_PORT=9090

# IP address to bind the metrics server to (use 127.0.0.1 for localhost only)
# Required: No
# Default: 127.0.0.1
METRICS_BIND_ADDRESS=127.0.0.1

# =============================================================================
# APPLICATION PATHS
# =============================================================================

# Path to database migration files
# Required: No
# Default: file://migrations
# Can be absolute path or relative to application root
MIGRATIONS_PATH=file://migrations

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

# Application log level
# Required: No
# Default: info
# Valid values: trace, debug, info, warn, error, fatal, panic
LOG_LEVEL=info

# Gin framework mode
# Required: No
# Default: debug
# Valid values: debug, release, test
# Use 'release' for production
GIN_MODE=debug

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# CSRF protection authentication key (base64 encoded 32-byte key)
# Required: No (optional, will be generated randomly if not provided)
# Default: (randomly generated)
# Generate with: openssl rand -base64 32
# CSRF_AUTH_KEY=Y/d8+wuibG279h+uW9lMjtfK+vT4eLRxRGSymI0nT1I=

# Content Security Policy header value
# Required: No
# Default: default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self'; connect-src 'self'; frame-ancestors 'none';
CONTENT_SECURITY_POLICY=default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self'; connect-src 'self'; frame-ancestors 'none';

# =============================================================================
# RATE LIMITING CONFIGURATION
# =============================================================================

# Rate limit for general authenticated API endpoints per API key
# Required: No
# Default: 100-M (100 requests per minute)
# Format: {number}-{period} where period can be S, M, H (second, minute, hour)
RATE_LIMIT_GENERAL=100-M

# Rate limit for /auth/register endpoint per IP address
# Required: No
# Default: 5-M (5 requests per minute)
# Format: {number}-{period} where period can be S, M, H (second, minute, hour)
RATE_LIMIT_REGISTER=5-M

# Rate limit for /auth/login and /auth/api-key endpoints per IP address
# Required: No
# Default: 10-M (10 requests per minute)
# Format: {number}-{period} where period can be S, M, H (second, minute, hour)
RATE_LIMIT_LOGIN=10-M

# Rate limit for /ingest endpoint per API key
# Required: No
# Default: 50-M (50 requests per minute)
# Format: {number}-{period} where period can be S, M, H (second, minute, hour)
RATE_LIMIT_INGEST=50-M

# =============================================================================
# REQUEST SIZE LIMITS
# =============================================================================

# Maximum request size for /ingest endpoint
# Required: No
# Default: 10MB
# Format: {number}{unit} where unit can be KB, MB, GB
MAX_REQUEST_SIZE_INGEST=10MB

# Maximum request size for POST/PUT/PATCH endpoints (except /ingest)
# Required: No
# Default: 1MB
# Format: {number}{unit} where unit can be KB, MB, GB
MAX_REQUEST_SIZE_POST=1MB

# Maximum request size for GET endpoints
# Required: No
# Default: 100KB
# Format: {number}{unit} where unit can be KB, MB, GB
MAX_REQUEST_SIZE_GET=100KB

# =============================================================================
# ADMIN USER CREATION (for create-admin command)
# =============================================================================

# Username for the initial admin user (used by create-admin command)
# Required: Yes (when using create-admin command)
# Default: (none)
ADMIN_USERNAME=admin

# Password for the initial admin user (used by create-admin command)
# Required: Yes (when using create-admin command)
# Default: (none)
ADMIN_PASSWORD=secure_password_here

# Email for the initial admin user (used by create-admin command)
# Required: Yes (when using create-admin command)
# Default: (none)
ADMIN_EMAIL=admin@example.com

# Organization name for the initial admin user (used by create-admin command)
# Required: Yes (when using create-admin command)
# Default: (none)
ADMIN_ORG_NAME=Default Organization

# =============================================================================
# TESTING CONFIGURATION
# =============================================================================

# Test database URL for running tests
# Required: No (only for testing)
# Default: (uses same as DATABASE_URL)
# TEST_DATABASE_URL=postgres://test:test@localhost:5432/snailbus_test?sslmode=disable

# =============================================================================
# NOTES
# =============================================================================
#
# 1. For production deployments:
#    - Set GIN_MODE=release
#    - Use strong passwords in DATABASE_URL
#    - Configure proper SSL/TLS settings
#    - Set appropriate rate limits for your traffic
#    - Generate a CSRF_AUTH_KEY and set it explicitly
#
# 2. Environment variable validation:
#    - Run `./snailbus --validate-config` to validate your configuration
#    - The application will fail to start with invalid configuration
#
# 3. Security considerations:
#    - Never commit real credentials to version control
#    - Use environment-specific .env files
#    - Rotate secrets regularly
#    - Use strong, unique passwords
